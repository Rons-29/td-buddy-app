# 📁 ファイル容量テスト機能

## 🎯 概要

TestData Buddy（TD）のファイル容量テスト機能は、指定したサイズのテストファイルを生成する機能です。アップロード制限のテスト、ストレージ容量の確認、パフォーマンステストなどに活用できます。

## ✨ 主要機能

### 🔢 ファイルサイズ指定

- **数値入力**: 小数点対応（例: 1.5MB）
- **単位選択**: B、KB、MB、GB
- **リアルタイム表示**: バイト数での実際のサイズ表示
- **クイックプリセット**: 1KB、100KB、1MB、10MB、100MB、1GB

### 📝 ファイル名設定

- **自由入力**: 任意のファイル名を指定可能
- **拡張子自動付与**: 選択した形式に応じて自動追加
- **デフォルト値**: `testfile` + 選択した拡張子

### 📄 ファイル形式

| 形式     | 拡張子 | 説明             | 用途                                 |
| -------- | ------ | ---------------- | ------------------------------------ |
| テキスト | .txt   | プレーンテキスト | 基本的なファイルテスト               |
| JSON     | .json  | 構造化データ     | API・データベーステスト              |
| CSV      | .csv   | 表形式データ     | データインポート・エクスポートテスト |
| XML      | .xml   | マークアップ     | 設定ファイル・データ交換テスト       |
| YAML     | .yaml  | 設定ファイル     | 設定管理・DevOps テスト              |
| データ   | .dat   | バイナリデータ   | 汎用ファイルテスト                   |

### 📚 コンテンツタイプ

#### 1. 青空文庫テキスト（推奨）

- **特徴**: 実際の日本語文学作品のテキストを使用
- **品質**: 自然な文章構造、読みやすい内容
- **作品**: 夏目漱石、太宰治、宮沢賢治などの名作
- **用途**: リアルなテキストデータでのテスト

#### 2. ランダムデータ

- **特徴**: 英数字のランダムな組み合わせ
- **用途**: パフォーマンステスト、容量テスト
- **メリット**: 予測困難なデータパターン

#### 3. ゼロ埋め

- **特徴**: すべて「0」で埋めたファイル
- **用途**: 最小限のデータでの容量テスト
- **メリット**: 圧縮率が高い、単純なパターン

## 🔧 使用方法

### 基本的な使い方

1. **サイズ設定**

   ```
   ファイルサイズ: 10
   単位: MB
   → 実際のサイズ: 10,485,760 バイト
   ```

2. **ファイル名入力**

   ```
   ファイル名: my-test-file
   形式: テキストファイル (.txt)
   → 生成ファイル名: my-test-file.txt
   ```

3. **コンテンツ選択**

   ```
   コンテンツタイプ: 青空文庫テキスト
   使用作品: 吾輩は猫である、こころ
   ```

4. **生成・ダウンロード**
   - 「ファイルを生成してダウンロード」ボタンをクリック
   - プログレスバーで進捗確認
   - 自動的にダウンロード開始

### プリセット活用

```
1KB: 小さなテスト（設定ファイルなど）
100KB: 中サイズファイル（画像・文書）
1MB: 画像・音声テスト
10MB: 大きなファイル（動画・データベース）
100MB: 動画・高解像度テスト
1GB: 大容量テスト（大規模データ）
```

## 🎨 UI/UX デザイン

### プログレッシブディスクロージャー対応

- **Level 1（初心者）**: プリセット選択中心
- **Level 2（中級者）**: 詳細設定表示
- **Level 3（上級者）**: 全機能アクセス

### TD キャラクター統合

```
開始時: 「ファイル容量テストの準備完了です！どんなサイズのファイルでも作れますよ♪」
設定時: 「1MBのファイル設定を適用しました！画像・音声テストに最適ですね♪」
生成中: 「データ生成中です。少々お待ちください♪」
完了時: 「✅ ファイル生成完了！testfile.txt (1.0 MB) をダウンロードしました♪」
```

### アクセシビリティ

- **キーボードナビゲーション**: Tab 順序最適化
- **スクリーンリーダー**: aria-label、role 属性設定
- **コントラスト**: WCAG 2.1 AA 準拠
- **フォーカス管理**: 視覚的フィードバック

## 🛡️ セキュリティ・制限

### ファイルサイズ制限

- **最大サイズ**: 1GB（ブラウザメモリ保護）
- **最小サイズ**: 1 バイト
- **推奨範囲**: 1KB〜100MB（実用的な範囲）

### プライバシー保護

- **ローカル生成**: すべてクライアントサイドで処理
- **サーバー非送信**: 生成データはサーバーに送信されない
- **一時的保存**: ダウンロード後はメモリから削除

### パフォーマンス最適化

- **メモリ管理**: 大容量ファイル生成時の最適化
- **プログレス表示**: 生成進捗の可視化
- **エラーハンドリング**: 適切な例外処理

## 📊 技術仕様

### フロントエンド

```typescript
interface FileSettings {
  size: string; // ファイルサイズ
  unit: "B" | "KB" | "MB" | "GB"; // サイズ単位
  filename: string; // ファイル名
  extension: string; // 拡張子
  contentType: string; // コンテンツタイプ
  selectedWorks: string[]; // 選択作品
}
```

### バックエンド型定義活用

```typescript
// 既存のfile-generator.tsの型を活用
FileGeneratorRequest;
FileGeneratorResponse;
FileMetadata;
FileSizeConfig;
```

### データ生成アルゴリズム

```typescript
1. ヘッダー情報生成（メタデータ）
2. 選択作品のコンテンツ循環配置
3. 目標サイズまでの繰り返し・切り詰め
4. ファイル形式別エンコーディング
5. Blob生成・ダウンロード実行
```

## 🧪 テストケース

### 機能テスト

- [ ] 各サイズ単位での正確な生成
- [ ] 各ファイル形式での適切なフォーマット
- [ ] プリセット設定の動作確認
- [ ] ファイル名の適切な処理

### パフォーマンステスト

- [ ] 1MB 生成: 5 秒以内
- [ ] 100MB 生成: 30 秒以内
- [ ] メモリ使用量: 512MB 以下
- [ ] 複数ファイル連続生成

### エラーハンドリングテスト

- [ ] 無効なサイズ入力
- [ ] 制限サイズ超過
- [ ] 空のファイル名
- [ ] ブラウザメモリ不足

## 🚀 使用例・シナリオ

### 1. アップロード制限テスト

```
目的: Webアプリケーションのファイルアップロード制限をテスト
設定:
- サイズ: 5MB（制限値）
- 形式: .jpg（画像ファイル）
- コンテンツ: ランダムデータ
```

### 2. ストレージ容量テスト

```
目的: データベースやストレージの容量限界をテスト
設定:
- サイズ: 1GB
- 形式: .dat
- コンテンツ: ゼロ埋め（圧縮効率チェック）
```

### 3. パフォーマンステスト

```
目的: 大容量ファイル処理のパフォーマンス測定
設定:
- サイズ: 100MB
- 形式: .json
- コンテンツ: 青空文庫（リアルなデータ構造）
```

### 4. データインポートテスト

```
目的: CSVインポート機能のテスト
設定:
- サイズ: 10MB
- 形式: .csv
- コンテンツ: 青空文庫（構造化データ）
```

## 🔄 将来の拡張機能

### 複数ファイル一括生成

- ZIP ファイルでの一括ダウンロード
- 異なるサイズの組み合わせ
- バッチ処理機能

### 高度なコンテンツ生成

- 画像ファイル生成（ダミー画像）
- 音声ファイル生成（無音・ノイズ）
- バイナリファイル生成

### クラウド連携

- クラウドストレージへの直接アップロード
- API 経由でのファイル生成
- リモートファイルサイズチェック

## 📈 期待効果

### 開発効率向上

- **テスト準備時間**: 80%短縮
- **手動作業削減**: ファイル準備の自動化
- **品質向上**: 一貫したテストデータ

### QA プロセス改善

- **テストケース拡充**: 様々なサイズでのテスト
- **再現性向上**: 同じ条件でのテスト実行
- **工数削減**: テストデータ作成時間の短縮

## 💡 TD からのアドバイス

```
🤖 「ファイル容量テスト機能の活用Tips」

✅ 推奨する使い方:
1. まずは小さなサイズ（1KB〜1MB）で動作確認
2. 青空文庫テキストでリアルなデータテスト
3. プリセットを活用して効率的な設定
4. 生成履歴を確認して再利用

⚠️ 注意点:
1. 1GB以上のファイルは避ける（ブラウザ負荷）
2. 連続生成時はメモリ使用量に注意
3. ダウンロード先の容量を事前確認

🎯 効果的なテストシナリオ:
- 制限値ぎりぎりのサイズでテスト
- 異なる形式での同一サイズテスト
- 段階的サイズ増加でのパフォーマンステスト

「一緒に効率的なファイル容量テストを実現しましょう♪」
```

---

## 🏷️ タグ

`#ファイル生成` `#容量テスト` `#パフォーマンステスト` `#青空文庫` `#TestDataBuddy` `#QAツール`
