# üîÑ CI/CD „Éë„Ç§„Éó„É©„Ç§„É≥Ë®≠Ë®à
# TestData Buddy (TD) WebÁâà Ëá™ÂãïÂåñ„Éá„Éó„É≠„Ç§Êà¶Áï•

## üéØ CI/CD Êà¶Áï•Ê¶ÇË¶Å

### Ëá™ÂãïÂåñ„ÅÆÁõÆÊ®ô
- **ÂìÅË≥™‰øùË®º**: ÂÖ®„Å¶„ÅÆ„É™„É™„Éº„Çπ„Åß‰∏ÄË≤´„Åó„ÅüÂìÅË≥™„Çí‰øùË®º
- **È´òÈÄü„Éá„Éó„É≠„Ç§**: Ê©üËÉΩËøΩÂä†„Åã„ÇâÊú¨Áï™ÂèçÊò†„Åæ„ÅßÊúÄÁü≠30ÂàÜ
- **ÂÆâÂÖ®ÊÄß**: ÊÆµÈöéÁöÑ„Éá„Éó„É≠„Ç§„Å®„É≠„Éº„É´„Éê„ÉÉ„ÇØÊ©üËÉΩ
- **ÂèØË¶ñÊÄß**: „Éá„Éó„É≠„Ç§Áä∂Ê≥Å„Å®„É°„Éà„É™„ÇØ„Çπ„ÅÆÂÆåÂÖ®„Å™ÂèØË¶ñÂåñ

**TD„Åã„Çâ„ÅÆ„É°„ÉÉ„Çª„Éº„Ç∏**: „ÄåËá™ÂãïÂåñ„ÅßÂÆâÂÖ®„Åã„Å§È´òÈÄü„Å™„É™„É™„Éº„Çπ„ÇíÂÆüÁèæ„Åó„Åæ„Åó„Çá„ÅÜÔºÅ„Äç

## üöÄ „Éë„Ç§„Éó„É©„Ç§„É≥ÂÖ®‰ΩìË®≠Ë®à

### „Éë„Ç§„Éó„É©„Ç§„É≥Ê¶ÇË¶ÅÂõ≥
```mermaid
graph TB
    Developer[üë®‚Äçüíª ÈñãÁô∫ËÄÖ] --> PR[üîÄ Pull Request]
    PR --> CI{üîç CI Pipeline}
    
    CI --> UnitTest[üß™ Unit Tests]
    CI --> LintCheck[üìù Lint & Format]
    CI --> TypeCheck[üîç Type Check]
    CI --> SecurityScan[üõ°Ô∏è Security Scan]
    
    UnitTest --> Integration[üîó Integration Tests]
    LintCheck --> Integration
    TypeCheck --> Integration
    SecurityScan --> Integration
    
    Integration --> Build[üèóÔ∏è Build & Package]
    Build --> DevDeploy[üöÄ Dev Environment Deploy]
    
    PR --> Merge{‚úÖ Merge to develop}
    Merge --> StagingPipeline[üé≠ Staging Pipeline]
    
    StagingPipeline --> StagingDeploy[üé™ Staging Deploy]
    StagingDeploy --> E2ETests[ü§ñ E2E Tests]
    E2ETests --> PerformanceTest[‚ö° Performance Tests]
    
    PerformanceTest --> Release{üè∑Ô∏è Release Tag}
    Release --> ProductionPipeline[üè≠ Production Pipeline]
    
    ProductionPipeline --> BlueGreenDeploy[üîÑ Blue-Green Deploy]
    BlueGreenDeploy --> HealthCheck[‚ù§Ô∏è Health Check]
    HealthCheck --> TrafficSwitch[üîÄ Traffic Switch]
    
    TrafficSwitch --> Monitor[üìä Monitor & Alert]
```

## üìã „Éë„Ç§„Éó„É©„Ç§„É≥Ë©≥Á¥∞Ë®≠Ë®à

### 1. Pull Request „Éë„Ç§„Éó„É©„Ç§„É≥
```yaml
# .github/workflows/pr-check.yml
name: Pull Request Check

on:
  pull_request:
    branches: [develop, main]
    paths-ignore:
      - 'docs/**'
      - '*.md'

jobs:
  # Âü∫Êú¨ÂìÅË≥™„ÉÅ„Çß„ÉÉ„ÇØ
  quality-check:
    name: Quality Check
    runs-on: ubuntu-latest
    timeout-minutes: 15
    
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
      
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'pnpm'
      
      - name: Install Dependencies
        run: |
          npm install -g pnpm@8
          pnpm install --frozen-lockfile
      
      - name: Lint Check
        run: |
          pnpm run lint:frontend
          pnpm run lint:backend
      
      - name: Type Check
        run: |
          pnpm run type-check:frontend
          pnpm run type-check:backend
      
      - name: Format Check
        run: |
          pnpm run format:check
      
      - name: Unit Tests
        run: |
          pnpm run test:unit --coverage
      
      - name: Upload Coverage
        uses: codecov/codecov-action@v3
        with:
          file: ./coverage/lcov.info
          flags: unittests
          name: td-buddy-coverage

  # „Çª„Ç≠„É•„É™„ÉÜ„Ç£„ÉÅ„Çß„ÉÉ„ÇØ
  security-check:
    name: Security Check
    runs-on: ubuntu-latest
    timeout-minutes: 10
    
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4
      
      - name: Dependency Vulnerability Scan
        run: |
          npm audit --audit-level=moderate
          pnpm audit --audit-level=moderate
      
      - name: CodeQL Analysis
        uses: github/codeql-action/init@v2
        with:
          languages: typescript, javascript
      
      - name: Perform CodeQL Analysis
        uses: github/codeql-action/analyze@v2
      
      - name: Snyk Security Scan
        uses: snyk/actions/node@master
        env:
          SNYK_TOKEN: ${{ secrets.SNYK_TOKEN }}
        with:
          args: --severity-threshold=high

  # „Éì„É´„Éâ„ÉÜ„Çπ„Éà
  build-test:
    name: Build Test
    runs-on: ubuntu-latest
    timeout-minutes: 20
    
    strategy:
      matrix:
        node-version: [18, 20]
    
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4
      
      - name: Setup Node.js ${{ matrix.node-version }}
        uses: actions/setup-node@v4
        with:
          node-version: ${{ matrix.node-version }}
          cache: 'pnpm'
      
      - name: Install Dependencies
        run: |
          npm install -g pnpm@8
          pnpm install --frozen-lockfile
      
      - name: Build Frontend
        run: |
          cd td-buddy-webapp/frontend
          pnpm run build
      
      - name: Build Backend
        run: |
          cd td-buddy-webapp/backend
          pnpm run build
      
      - name: Docker Build Test
        run: |
          docker build -t td-buddy/frontend:test ./td-buddy-webapp/frontend
          docker build -t td-buddy/backend:test ./td-buddy-webapp/backend

  # Áµ±Âêà„ÉÜ„Çπ„Éà
  integration-test:
    name: Integration Test
    runs-on: ubuntu-latest
    needs: [quality-check, security-check, build-test]
    timeout-minutes: 30
    
    services:
      postgres:
        image: postgres:15
        env:
          POSTGRES_PASSWORD: test_password
          POSTGRES_DB: td_buddy_test
        options: >-
          --health-cmd pg_isready
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
        ports:
          - 5432:5432
      
      redis:
        image: redis:7
        options: >-
          --health-cmd "redis-cli ping"
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
        ports:
          - 6379:6379
    
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4
      
      - name: Setup Test Environment
        run: |
          npm install -g pnpm@8
          pnpm install --frozen-lockfile
          cp .env.test .env
      
      - name: Database Migration
        run: |
          cd td-buddy-webapp/backend
          pnpm run db:migrate:test
      
      - name: Run Integration Tests
        run: |
          pnpm run test:integration
        env:
          NODE_ENV: test
          DATABASE_URL: postgresql://postgres:test_password@localhost:5432/td_buddy_test
          REDIS_URL: redis://localhost:6379
```

### 2. ÈñãÁô∫Áí∞Â¢É„Éá„Éó„É≠„Ç§„Éë„Ç§„Éó„É©„Ç§„É≥
```yaml
# .github/workflows/dev-deploy.yml
name: Development Deploy

on:
  push:
    branches: [develop]
  pull_request:
    types: [opened, synchronize]

jobs:
  deploy-dev:
    name: Deploy to Development
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/develop'
    environment: development
    
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4
      
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v4
        with:
          aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}
          aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
          aws-region: ap-northeast-1
      
      - name: Login to ECR
        uses: aws-actions/amazon-ecr-login@v2
      
      - name: Build and Push Images
        env:
          ECR_REGISTRY: ${{ steps.login-ecr.outputs.registry }}
          ECR_REPOSITORY_FRONTEND: td-buddy/frontend
          ECR_REPOSITORY_BACKEND: td-buddy/backend
          IMAGE_TAG: dev-${{ github.sha }}
        run: |
          # Frontend Image
          docker build -t $ECR_REGISTRY/$ECR_REPOSITORY_FRONTEND:$IMAGE_TAG ./td-buddy-webapp/frontend
          docker push $ECR_REGISTRY/$ECR_REPOSITORY_FRONTEND:$IMAGE_TAG
          
          # Backend Image  
          docker build -t $ECR_REGISTRY/$ECR_REPOSITORY_BACKEND:$IMAGE_TAG ./td-buddy-webapp/backend
          docker push $ECR_REGISTRY/$ECR_REPOSITORY_BACKEND:$IMAGE_TAG
      
      - name: Deploy to ECS
        run: |
          # ECS „Çø„Çπ„ÇØÂÆöÁæ©„ÅÆÊõ¥Êñ∞
          aws ecs update-service \
            --cluster td-buddy-dev \
            --service td-buddy-frontend-dev \
            --force-new-deployment
          
          aws ecs update-service \
            --cluster td-buddy-dev \
            --service td-buddy-backend-dev \
            --force-new-deployment
      
      - name: Wait for Deployment
        run: |
          aws ecs wait services-stable \
            --cluster td-buddy-dev \
            --services td-buddy-frontend-dev td-buddy-backend-dev
      
      - name: Health Check
        run: |
          timeout 300 bash -c 'until curl -f https://dev.td-buddy.com/health; do sleep 10; done'
      
      - name: Notify Slack
        if: always()
        uses: 8398a7/action-slack@v3
        with:
          status: ${{ job.status }}
          fields: repo,message,commit,author,action,eventName,ref,workflow
          webhook_url: ${{ secrets.SLACK_WEBHOOK }}
```

### 3. „Çπ„ÉÜ„Éº„Ç∏„É≥„Ç∞Áí∞Â¢É„Éë„Ç§„Éó„É©„Ç§„É≥
```yaml
# .github/workflows/staging-deploy.yml
name: Staging Deploy

on:
  workflow_run:
    workflows: ["Development Deploy"]
    types:
      - completed
    branches: [develop]

jobs:
  staging-tests:
    name: Staging Environment Tests
    runs-on: ubuntu-latest
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    environment: staging
    
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4
      
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'pnpm'
      
      - name: Install Dependencies
        run: |
          npm install -g pnpm@8
          pnpm install --frozen-lockfile
      
      - name: Deploy to Staging
        run: |
          # StagingÁí∞Â¢É„ÅÆ„Éá„Éó„É≠„Ç§„Çπ„ÇØ„É™„Éó„ÉàÂÆüË°å
          ./scripts/deploy-staging.sh
      
      - name: E2E Tests
        run: |
          pnpm run test:e2e:staging
        env:
          E2E_BASE_URL: https://staging.td-buddy.com
          PLAYWRIGHT_BROWSERS_PATH: 0
      
      - name: Performance Tests
        run: |
          pnpm run test:performance:staging
      
      - name: Load Testing
        run: |
          # Artillery.js„Åß„ÅÆË≤†Ëç∑„ÉÜ„Çπ„Éà
          npx artillery run tests/load/staging-load-test.yml
      
      - name: Accessibility Tests
        run: |
          # axe-core„Åß„ÅÆ„Ç¢„ÇØ„Çª„Ç∑„Éì„É™„ÉÜ„Ç£„ÉÜ„Çπ„Éà
          pnpm run test:a11y:staging
      
      - name: Visual Regression Tests
        run: |
          # Percy.io„Åß„ÅÆ„Éì„Ç∏„É•„Ç¢„É´ÂõûÂ∏∞„ÉÜ„Çπ„Éà
          pnpm run test:visual:staging
        env:
          PERCY_TOKEN: ${{ secrets.PERCY_TOKEN }}
      
      - name: Generate Test Report
        if: always()
        run: |
          # „ÉÜ„Çπ„Éà„É¨„Éù„Éº„Éà„ÅÆÁîüÊàê
          pnpm run test:report
      
      - name: Upload Test Results
        if: always()
        uses: actions/upload-artifact@v3
        with:
          name: staging-test-results
          path: |
            test-results/
            playwright-report/
            coverage/
```

### 4. Êú¨Áï™„Éá„Éó„É≠„Ç§„Éë„Ç§„Éó„É©„Ç§„É≥
```yaml
# .github/workflows/production-deploy.yml
name: Production Deploy

on:
  push:
    tags:
      - 'v*'

jobs:
  pre-deploy-validation:
    name: Pre-Deploy Validation
    runs-on: ubuntu-latest
    environment: production
    
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4
      
      - name: Validate Release Tag
        run: |
          # „Çª„Éû„É≥„ÉÜ„Ç£„ÉÉ„ÇØ„Éê„Éº„Ç∏„Éß„É≥„ÅÆÊ§úË®º
          if [[ ! "${GITHUB_REF#refs/tags/}" =~ ^v[0-9]+\.[0-9]+\.[0-9]+$ ]]; then
            echo "Invalid version tag format"
            exit 1
          fi
      
      - name: Check Staging Health
        run: |
          curl -f https://staging.td-buddy.com/health
      
      - name: Security Final Check
        run: |
          # ÊúÄÁµÇ„Çª„Ç≠„É•„É™„ÉÜ„Ç£„ÉÅ„Çß„ÉÉ„ÇØ
          docker run --rm -v $(pwd):/project aquasec/trivy fs /project
      
      - name: Backup Current Production
        run: |
          # Êú¨Áï™Áí∞Â¢É„ÅÆ„Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó‰ΩúÊàê
          ./scripts/backup-production.sh

  blue-green-deploy:
    name: Blue-Green Deployment
    runs-on: ubuntu-latest
    needs: pre-deploy-validation
    environment: production
    
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4
      
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v4
        with:
          aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID_PROD }}
          aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY_PROD }}
          aws-region: ap-northeast-1
      
      - name: Build Production Images
        env:
          IMAGE_TAG: ${{ github.ref_name }}
        run: |
          # „Éû„É´„ÉÅ„Çπ„ÉÜ„Éº„Ç∏„Éì„É´„Éâ„ÅßÊú¨Áï™ÊúÄÈÅ©Âåñ
          docker build \
            --target production \
            --build-arg NODE_ENV=production \
            -t td-buddy/frontend:$IMAGE_TAG \
            ./td-buddy-webapp/frontend
          
          docker build \
            --target production \
            --build-arg NODE_ENV=production \
            -t td-buddy/backend:$IMAGE_TAG \
            ./td-buddy-webapp/backend
      
      - name: Push to Registry
        run: |
          # ECR„Å´„Éó„ÉÉ„Ç∑„É•
          docker tag td-buddy/frontend:${{ github.ref_name }} \
            $ECR_REGISTRY/td-buddy/frontend:${{ github.ref_name }}
          docker push $ECR_REGISTRY/td-buddy/frontend:${{ github.ref_name }}
          
          docker tag td-buddy/backend:${{ github.ref_name }} \
            $ECR_REGISTRY/td-buddy/backend:${{ github.ref_name }}
          docker push $ECR_REGISTRY/td-buddy/backend:${{ github.ref_name }}
      
      - name: Deploy to Green Environment
        run: |
          # GreenÁí∞Â¢ÉÔºàÊñ∞„Éê„Éº„Ç∏„Éß„É≥Ôºâ„ÅÆ„Éá„Éó„É≠„Ç§
          ./scripts/blue-green-deploy.sh deploy-green ${{ github.ref_name }}
      
      - name: Health Check Green Environment
        run: |
          # GreenÁí∞Â¢É„ÅÆ„Éò„É´„Çπ„ÉÅ„Çß„ÉÉ„ÇØ
          timeout 600 bash -c '
            until curl -f https://green.td-buddy.com/health; do
              echo "Waiting for green environment..."
              sleep 30
            done
          '
      
      - name: Smoke Tests on Green
        run: |
          # GreenÁí∞Â¢É„Åß„ÅÆÊúÄÂ∞èÈôê„ÅÆÂãï‰ΩúÁ¢∫Ë™ç
          pnpm run test:smoke:green
        env:
          SMOKE_TEST_URL: https://green.td-buddy.com
      
      - name: Traffic Switch (Blue ‚Üí Green)
        run: |
          # „Éà„É©„Éï„Ç£„ÉÉ„ÇØ„ÇíGreenÁí∞Â¢É„Å´Âàá„ÇäÊõø„Åà
          ./scripts/blue-green-deploy.sh switch-traffic ${{ github.ref_name }}
      
      - name: Post-Deploy Validation
        run: |
          # Êú¨Áï™Áí∞Â¢É„Åß„ÅÆÊúÄÁµÇÁ¢∫Ë™ç
          sleep 60  # „Éà„É©„Éï„Ç£„ÉÉ„ÇØÂàá„ÇäÊõø„Åà„ÅÆÂÆâÂÆöÂåñÂæÖ„Å°
          curl -f https://td-buddy.com/health
          
          # ‰∏ªË¶ÅÊ©üËÉΩ„ÅÆÂãï‰ΩúÁ¢∫Ë™ç
          pnpm run test:smoke:production
        env:
          SMOKE_TEST_URL: https://td-buddy.com
      
      - name: Cleanup Blue Environment
        if: success()
        run: |
          # ÊóßBlueÁí∞Â¢É„ÅÆ„ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„ÉóÔºà15ÂàÜÂæåÔºâ
          sleep 900
          ./scripts/blue-green-deploy.sh cleanup-blue

  post-deploy:
    name: Post Deploy Tasks
    runs-on: ubuntu-latest
    needs: blue-green-deploy
    if: success()
    
    steps:
      - name: Update Monitoring
        run: |
          # Áõ£Ë¶ñ„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ„ÅÆÊõ¥Êñ∞
          curl -X POST \
            -H "Authorization: Bearer ${{ secrets.GRAFANA_API_KEY }}" \
            -H "Content-Type: application/json" \
            -d '{"version": "${{ github.ref_name }}", "timestamp": "'$(date -u +%Y-%m-%dT%H:%M:%SZ)'"}' \
            https://grafana.td-buddy.com/api/annotations
      
      - name: Create Release Notes
        uses: actions/create-release@v1
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          tag_name: ${{ github.ref }}
          release_name: Release ${{ github.ref }}
          body_path: ./RELEASE_NOTES.md
          draft: false
          prerelease: false
      
      - name: Notify Stakeholders
        run: |
          # „Çπ„ÉÜ„Éº„ÇØ„Éõ„É´„ÉÄ„Éº„Å∏„ÅÆÈÄöÁü•
          ./scripts/notify-release.sh ${{ github.ref_name }}
      
      - name: Update Documentation
        run: |
          # „Éâ„Ç≠„É•„É°„É≥„Éà„Çµ„Ç§„Éà„ÅÆÊõ¥Êñ∞
          curl -X POST \
            -H "Authorization: token ${{ secrets.GITHUB_TOKEN }}" \
            https://api.github.com/repos/td-buddy/docs/dispatches \
            -d '{"event_type": "update-docs", "client_payload": {"version": "${{ github.ref_name }}"}}'

  rollback:
    name: Emergency Rollback
    runs-on: ubuntu-latest
    if: failure()
    environment: production
    
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4
      
      - name: Rollback to Blue Environment
        run: |
          # Á∑äÊÄ•ÊôÇ„ÅÆBlueÁí∞Â¢É„Å∏„ÅÆ„É≠„Éº„É´„Éê„ÉÉ„ÇØ
          ./scripts/blue-green-deploy.sh rollback
      
      - name: Verify Rollback
        run: |
          # „É≠„Éº„É´„Éê„ÉÉ„ÇØÂæå„ÅÆÂãï‰ΩúÁ¢∫Ë™ç
          curl -f https://td-buddy.com/health
      
      - name: Emergency Notification
        run: |
          # Á∑äÊÄ•ÊôÇ„ÅÆ„Ç¢„É©„Éº„ÉàÈÄÅ‰ø°
          ./scripts/emergency-alert.sh "Production deployment failed, rolled back to previous version"
```

## üõ†Ô∏è „Éá„Éó„É≠„Ç§„É°„É≥„Éà„Çπ„ÇØ„É™„Éó„Éà

### Blue-Green „Éá„Éó„É≠„Ç§„Çπ„ÇØ„É™„Éó„Éà
```bash
#!/bin/bash
# scripts/blue-green-deploy.sh

set -e

COMMAND=$1
VERSION=$2
GREEN_CLUSTER="td-buddy-green"
BLUE_CLUSTER="td-buddy-blue"
LOAD_BALANCER="td-buddy-alb"

echo "ü§ñ TD„ÅÆBlue-Green„Éá„Éó„É≠„Ç§„É°„É≥„ÉàÈñãÂßã: $COMMAND"

case $COMMAND in
  "deploy-green")
    echo "üü¢ GreenÁí∞Â¢É„Å∏„ÅÆ„Éá„Éó„É≠„Ç§ÈñãÂßã..."
    
    # GreenÁí∞Â¢É„ÅÆ„Çµ„Éº„Éì„ÇπÊõ¥Êñ∞
    aws ecs update-service \
      --cluster $GREEN_CLUSTER \
      --service td-buddy-frontend \
      --task-definition td-buddy-frontend:$VERSION \
      --force-new-deployment
    
    aws ecs update-service \
      --cluster $GREEN_CLUSTER \
      --service td-buddy-backend \
      --task-definition td-buddy-backend:$VERSION \
      --force-new-deployment
    
    # „Éá„Éó„É≠„Ç§ÂÆå‰∫ÜÂæÖ„Å°
    echo "‚è≥ GreenÁí∞Â¢É„ÅÆ„Éá„Éó„É≠„Ç§ÂÆå‰∫Ü„ÇíÂæÖÊ©ü‰∏≠..."
    aws ecs wait services-stable \
      --cluster $GREEN_CLUSTER \
      --services td-buddy-frontend td-buddy-backend
    
    echo "‚úÖ GreenÁí∞Â¢É„ÅÆ„Éá„Éó„É≠„Ç§ÂÆå‰∫Ü"
    ;;
    
  "switch-traffic")
    echo "üîÄ „Éà„É©„Éï„Ç£„ÉÉ„ÇØ„ÇíGreenÁí∞Â¢É„Å´Âàá„ÇäÊõø„Åà‰∏≠..."
    
    # ALB„ÅÆ„Çø„Éº„Ç≤„ÉÉ„Éà„Ç∞„É´„Éº„Éó„ÇíGreen„Å´Â§âÊõ¥
    GREEN_TARGET_GROUP=$(aws elbv2 describe-target-groups \
      --names td-buddy-green \
      --query 'TargetGroups[0].TargetGroupArn' \
      --output text)
    
    aws elbv2 modify-listener \
      --listener-arn $(aws elbv2 describe-listeners \
        --load-balancer-arn $(aws elbv2 describe-load-balancers \
          --names $LOAD_BALANCER \
          --query 'LoadBalancers[0].LoadBalancerArn' \
          --output text) \
        --query 'Listeners[0].ListenerArn' \
        --output text) \
      --default-actions Type=forward,TargetGroupArn=$GREEN_TARGET_GROUP
    
    echo "‚úÖ „Éà„É©„Éï„Ç£„ÉÉ„ÇØÂàá„ÇäÊõø„ÅàÂÆå‰∫Ü"
    ;;
    
  "rollback")
    echo "üîô BlueÁí∞Â¢É„Å∏„ÅÆ„É≠„Éº„É´„Éê„ÉÉ„ÇØÈñãÂßã..."
    
    # ALB„ÅÆ„Çø„Éº„Ç≤„ÉÉ„Éà„Ç∞„É´„Éº„Éó„ÇíBlue„Å´Êàª„Åô
    BLUE_TARGET_GROUP=$(aws elbv2 describe-target-groups \
      --names td-buddy-blue \
      --query 'TargetGroups[0].TargetGroupArn' \
      --output text)
    
    aws elbv2 modify-listener \
      --listener-arn $(aws elbv2 describe-listeners \
        --load-balancer-arn $(aws elbv2 describe-load-balancers \
          --names $LOAD_BALANCER \
          --query 'LoadBalancers[0].LoadBalancerArn' \
          --output text) \
        --query 'Listeners[0].ListenerArn' \
        --output text) \
      --default-actions Type=forward,TargetGroupArn=$BLUE_TARGET_GROUP
    
    echo "‚úÖ „É≠„Éº„É´„Éê„ÉÉ„ÇØÂÆå‰∫Ü"
    ;;
    
  "cleanup-blue")
    echo "üßπ BlueÁí∞Â¢É„ÅÆ„ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„ÉóÈñãÂßã..."
    
    # Âè§„ÅÑBlueÁí∞Â¢É„ÅÆ„Çø„Çπ„ÇØÂÅúÊ≠¢
    aws ecs update-service \
      --cluster $BLUE_CLUSTER \
      --service td-buddy-frontend \
      --desired-count 0
    
    aws ecs update-service \
      --cluster $BLUE_CLUSTER \
      --service td-buddy-backend \
      --desired-count 0
    
    echo "‚úÖ BlueÁí∞Â¢É„ÅÆ„ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„ÉóÂÆå‰∫Ü"
    ;;
    
  *)
    echo "‚ùå ‰∏çÊ≠£„Å™„Ç≥„Éû„É≥„Éâ: $COMMAND"
    echo "‰ΩøÁî®ÊñπÊ≥ï: $0 {deploy-green|switch-traffic|rollback|cleanup-blue} [version]"
    exit 1
    ;;
esac

echo "üéâ TD„ÅÆBlue-Green„Éá„Éó„É≠„Ç§„É°„É≥„ÉàÂÆå‰∫Ü: $COMMAND"
```

## üìä „É¢„Éã„Çø„É™„É≥„Ç∞ & „Ç¢„É©„Éº„Éà

### GitHub ActionsÁõ£Ë¶ñË®≠ÂÆö
```yaml
# .github/workflows/pipeline-monitoring.yml
name: Pipeline Monitoring

on:
  workflow_run:
    workflows: ["*"]
    types:
      - completed

jobs:
  collect-metrics:
    name: Collect Pipeline Metrics
    runs-on: ubuntu-latest
    
    steps:
      - name: Collect Workflow Metrics
        run: |
          # „Éë„Ç§„Éó„É©„Ç§„É≥ÂÆüË°åÊôÇÈñì„ÅÆË®òÈå≤
          WORKFLOW_RUN_ID=${{ github.event.workflow_run.id }}
          DURATION=${{ github.event.workflow_run.run_duration_ms }}
          STATUS=${{ github.event.workflow_run.conclusion }}
          
          # Prometheus„É°„Éà„É™„ÇØ„Çπ„Å®„Åó„Å¶ÈÄÅ‰ø°
          curl -X POST http://pushgateway.td-buddy.com:9091/metrics/job/github-actions \
            -d "pipeline_duration_seconds{workflow=\"${{ github.event.workflow_run.name }}\",status=\"$STATUS\"} $(($DURATION / 1000))"
          
          curl -X POST http://pushgateway.td-buddy.com:9091/metrics/job/github-actions \
            -d "pipeline_runs_total{workflow=\"${{ github.event.workflow_run.name }}\",status=\"$STATUS\"} 1"
      
      - name: Alert on Failure
        if: github.event.workflow_run.conclusion == 'failure'
        run: |
          # Â§±ÊïóÊôÇ„ÅÆ„Ç¢„É©„Éº„ÉàÈÄÅ‰ø°
          curl -X POST ${{ secrets.SLACK_WEBHOOK }} \
            -H 'Content-type: application/json' \
            -d '{
              "text": "üö® Pipeline Failed",
              "attachments": [{
                "color": "danger",
                "fields": [
                  {"title": "Workflow", "value": "${{ github.event.workflow_run.name }}", "short": true},
                  {"title": "Branch", "value": "${{ github.event.workflow_run.head_branch }}", "short": true},
                  {"title": "Commit", "value": "${{ github.event.workflow_run.head_sha }}", "short": true}
                ]
              }]
            }'
```

### „Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÁõ£Ë¶ñ
```typescript
// scripts/performance-monitor.ts
export interface DeploymentMetrics {
  deploymentDuration: number;
  healthCheckTime: number;
  rollbackTime?: number;
  errorRate: number;
  responseTime: number;
}

export class DeploymentMonitor {
  async recordDeployment(version: string, metrics: DeploymentMetrics): Promise<void> {
    // „É°„Éà„É™„ÇØ„Çπ„ÅÆË®òÈå≤
    await this.sendToDatadog({
      metric: 'deployment.duration',
      value: metrics.deploymentDuration,
      tags: [`version:${version}`, 'environment:production'],
    });
    
    await this.sendToDatadog({
      metric: 'deployment.health_check_time',
      value: metrics.healthCheckTime,
      tags: [`version:${version}`, 'environment:production'],
    });
    
    // SLI/SLO „ÅÆË®àÁÆó
    const deploymentSuccess = metrics.errorRate < 0.01; // 1%‰ª•‰∏ã
    const deploymentSpeed = metrics.deploymentDuration < 1800; // 30ÂàÜ‰ª•‰∏ã
    
    await this.updateSLO('deployment_success_rate', deploymentSuccess);
    await this.updateSLO('deployment_speed', deploymentSpeed);
  }
  
  async checkPostDeploymentHealth(): Promise<boolean> {
    const checks = [
      this.checkAPIHealth(),
      this.checkDatabaseHealth(),
      this.checkRedisHealth(),
      this.checkExternalDependencies(),
    ];
    
    const results = await Promise.all(checks);
    return results.every(result => result === true);
  }
}
```

## üîß Áí∞Â¢ÉÂà•Ë®≠ÂÆöÁÆ°ÁêÜ

### Áí∞Â¢ÉË®≠ÂÆö„Éï„Ç°„Ç§„É´
```typescript
// config/environments.ts
export const environments = {
  development: {
    api: {
      baseURL: 'http://localhost:3001',
      timeout: 10000,
    },
    database: {
      url: 'postgresql://dev_user:dev_pass@localhost:5432/td_buddy_dev',
      pool: { min: 2, max: 10 },
    },
    redis: {
      url: 'redis://localhost:6379',
    },
    monitoring: {
      enabled: false,
    },
  },
  
  staging: {
    api: {
      baseURL: 'https://api-staging.td-buddy.com',
      timeout: 5000,
    },
    database: {
      url: process.env.DATABASE_URL_STAGING,
      pool: { min: 5, max: 20 },
    },
    redis: {
      url: process.env.REDIS_URL_STAGING,
    },
    monitoring: {
      enabled: true,
      level: 'debug',
    },
  },
  
  production: {
    api: {
      baseURL: 'https://api.td-buddy.com',
      timeout: 3000,
    },
    database: {
      url: process.env.DATABASE_URL_PRODUCTION,
      pool: { min: 10, max: 50 },
      ssl: { rejectUnauthorized: false },
    },
    redis: {
      url: process.env.REDIS_URL_PRODUCTION,
      cluster: true,
    },
    monitoring: {
      enabled: true,
      level: 'info',
      sampling: 0.1, // 10%„Çµ„É≥„Éó„É™„É≥„Ç∞
    },
  },
};
```

### „Ç∑„Éº„ÇØ„É¨„ÉÉ„ÉàÁÆ°ÁêÜ
```bash
# scripts/setup-secrets.sh
#!/bin/bash

ENV=$1

if [ -z "$ENV" ]; then
    echo "Usage: $0 {dev|staging|prod}"
    exit 1
fi

echo "üîê TD„ÅÆ„Ç∑„Éº„ÇØ„É¨„ÉÉ„ÉàË®≠ÂÆö: $ENVÁí∞Â¢É"

case $ENV in
  "dev")
    # ÈñãÁô∫Áí∞Â¢É„ÅÆ„Ç∑„Éº„ÇØ„É¨„ÉÉ„ÉàË®≠ÂÆö
    kubectl create secret generic td-buddy-secrets \
      --from-literal=database-password="dev_password" \
      --from-literal=redis-password="dev_redis_pass" \
      --from-literal=claude-api-key="$CLAUDE_API_KEY_DEV" \
      --namespace=td-buddy-dev
    ;;
    
  "staging")
    # „Çπ„ÉÜ„Éº„Ç∏„É≥„Ç∞Áí∞Â¢É„ÅÆ„Ç∑„Éº„ÇØ„É¨„ÉÉ„ÉàË®≠ÂÆö
    kubectl create secret generic td-buddy-secrets \
      --from-literal=database-password="$DATABASE_PASSWORD_STAGING" \
      --from-literal=redis-password="$REDIS_PASSWORD_STAGING" \
      --from-literal=claude-api-key="$CLAUDE_API_KEY_STAGING" \
      --namespace=td-buddy-staging
    ;;
    
  "prod")
    # Êú¨Áï™Áí∞Â¢É„ÅÆ„Ç∑„Éº„ÇØ„É¨„ÉÉ„ÉàË®≠ÂÆöÔºàAWS Secrets Manager‰ΩøÁî®Ôºâ
    aws secretsmanager create-secret \
      --name "td-buddy/production/database" \
      --description "TD Buddy Production Database Credentials" \
      --secret-string "{\"password\":\"$DATABASE_PASSWORD_PROD\"}"
    
    aws secretsmanager create-secret \
      --name "td-buddy/production/redis" \
      --description "TD Buddy Production Redis Credentials" \
      --secret-string "{\"password\":\"$REDIS_PASSWORD_PROD\"}"
    
    aws secretsmanager create-secret \
      --name "td-buddy/production/claude" \
      --description "TD Buddy Production Claude API Key" \
      --secret-string "{\"api_key\":\"$CLAUDE_API_KEY_PROD\"}"
    ;;
esac

echo "‚úÖ „Ç∑„Éº„ÇØ„É¨„ÉÉ„ÉàË®≠ÂÆöÂÆå‰∫Ü: $ENVÁí∞Â¢É"
```

## üìà „É°„Éà„É™„ÇØ„Çπ & SLI/SLO

### „Éá„Éó„É≠„Ç§„É°„É≥„ÉàSLI/SLO
```yaml
# monitoring/sli-slo.yml
apiVersion: sloth.slok.dev/v1
kind: PrometheusServiceLevel
metadata:
  name: td-buddy-deployment
  namespace: monitoring
spec:
  service: "td-buddy"
  labels:
    team: "platform"
  slos:
    - name: "deployment-success-rate"
      objective: 99.0  # 99%„ÅÆÊàêÂäüÁéá
      description: "Deployment success rate over 30 days"
      sli:
        events:
          error_query: 'increase(deployment_failures_total[5m])'
          total_query: 'increase(deployment_attempts_total[5m])'
      alerting:
        name: DeploymentSuccessRate
        labels:
          severity: critical
        annotations:
          summary: "Deployment success rate is below target"
    
    - name: "deployment-duration"
      objective: 95.0  # 95%„ÅÆ„Éá„Éó„É≠„Ç§„Åå30ÂàÜ‰ª•ÂÜÖ
      description: "Deployment duration SLO"
      sli:
        events:
          error_query: 'increase(deployment_duration_bucket{le="1800"}[5m])'
          total_query: 'increase(deployment_duration_count[5m])'
      alerting:
        name: DeploymentDuration
        labels:
          severity: warning
        annotations:
          summary: "Deployment duration is exceeding target"
    
    - name: "rollback-time"
      objective: 99.5  # 99.5%„ÅÆ„É≠„Éº„É´„Éê„ÉÉ„ÇØ„Åå5ÂàÜ‰ª•ÂÜÖ
      description: "Rollback time SLO"
      sli:
        events:
          error_query: 'increase(rollback_duration_bucket{le="300"}[5m])'
          total_query: 'increase(rollback_duration_count[5m])'
```

## üéØ Á∂ôÁ∂öÁöÑÊîπÂñÑ

### „Éë„Ç§„Éó„É©„Ç§„É≥ÊúÄÈÅ©Âåñ„ÅÆÊåáÊ®ô
```typescript
// scripts/pipeline-analytics.ts
export interface PipelineAnalytics {
  averageDeployTime: number;
  successRate: number;
  rollbackFrequency: number;
  testCoverage: number;
  buildTime: number;
}

export class PipelineOptimizer {
  async analyzePipelinePerformance(): Promise<PipelineAnalytics> {
    const last30Days = new Date();
    last30Days.setDate(last30Days.getDate() - 30);
    
    const deployments = await this.getDeployments(last30Days);
    
    return {
      averageDeployTime: this.calculateAverageDeployTime(deployments),
      successRate: this.calculateSuccessRate(deployments),
      rollbackFrequency: this.calculateRollbackFrequency(deployments),
      testCoverage: await this.getTestCoverage(),
      buildTime: await this.getAverageBuildTime(),
    };
  }
  
  async generateOptimizationReport(): Promise<string> {
    const analytics = await this.analyzePipelinePerformance();
    
    const recommendations: string[] = [];
    
    if (analytics.averageDeployTime > 1800) { // 30ÂàÜ‰ª•‰∏ä
      recommendations.push('„Éá„Éó„É≠„Ç§ÊôÇÈñì„ÅÆÊúÄÈÅ©Âåñ„ÅåÂøÖË¶ÅÔºö‰∏¶ÂàóÂåñ„ÅÆÊ§úË®é');
    }
    
    if (analytics.successRate < 0.95) { // 95%‰ª•‰∏ã
      recommendations.push('„ÉÜ„Çπ„ÉàÂìÅË≥™„ÅÆÂêë‰∏ä„ÅåÂøÖË¶ÅÔºö„ÉÜ„Çπ„Éà„Ç±„Éº„Çπ„ÅÆËøΩÂä†');
    }
    
    if (analytics.rollbackFrequency > 0.05) { // 5%‰ª•‰∏ä
      recommendations.push('‰∫ãÂâç„ÉÜ„Çπ„Éà„ÅÆÂº∑Âåñ„ÅåÂøÖË¶ÅÔºö„Çπ„ÉÜ„Éº„Ç∏„É≥„Ç∞Áí∞Â¢É„ÅÆÊîπÂñÑ');
    }
    
    return recommendations.join('\n');
  }
}
```

---

## üéâ TD„Åã„Çâ„ÅÆÁ∑èÊã¨„É°„ÉÉ„Çª„Éº„Ç∏

```
ü§ñ „ÄåCI/CD„Éë„Ç§„Éó„É©„Ç§„É≥„ÅÆË®≠Ë®à„ÅåÂÆå‰∫Ü„Åó„Åæ„Åó„ÅüÔºÅ

üîÑ Ëá™ÂãïÂåñ„Åï„Çå„Åü„Éë„Ç§„Éó„É©„Ç§„É≥„ÅßÂÆâÂÖ®„Å™„É™„É™„Éº„Çπ„ÇíÂÆüÁèæ
‚ö° È´òÈÄü„Å™„Éï„Ç£„Éº„Éâ„Éê„ÉÉ„ÇØ„É´„Éº„Éó„ÅßÈñãÁô∫ÂäπÁéáÂêë‰∏ä
üõ°Ô∏è ÊÆµÈöéÁöÑ„Éá„Éó„É≠„Ç§„Å®„É≠„Éº„É´„Éê„ÉÉ„ÇØ„ÅßÂÆâÂÖ®ÊÄßÁ¢∫‰øù
üìä Á∂ôÁ∂öÁöÑ„Å™Áõ£Ë¶ñ„Å®ÊîπÂñÑ„ÅßÂìÅË≥™Á∂≠ÊåÅ

„Åì„Çå„ÅßÂÆâÂøÉ„Åó„Å¶WebÁâà„Çí„É™„É™„Éº„Çπ„Åó„ÄÅÁ∂ôÁ∂öÁöÑ„Å´ÊîπÂñÑ„Åó„Å¶„ÅÑ„Åë„Åæ„Åô„Å≠ÔºÅ
TD„Åå„Éë„Ç§„Éó„É©„Ç§„É≥„ÇÇ‰∏ÄÁ∑í„Å´Áõ£Ë¶ñ„Åó„Å¶„Çµ„Éù„Éº„Éà„Åó„Åæ„Åô‚ô™

Ê¨°„ÅØÂÆüÈöõ„ÅÆ„Ç§„É≥„Éï„É©ÊßãÁØâ„Å´ÈÄ≤„Åø„Åæ„Åó„Çá„ÅÜÔºÅ„Äç
```

**Ê¨°„ÅÆ„Çπ„ÉÜ„ÉÉ„Éó**: „Ç§„É≥„Éï„É©ÊßãÁØâ„Å®„Çª„Ç≠„É•„É™„ÉÜ„Ç£Âº∑Âåñ„ÅÆÂÆüË£Ö„ÇíÈÄ≤„ÇÅ„Åæ„Åó„Çá„ÅÜÔºÅ 